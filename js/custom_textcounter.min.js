!function(a){a.textcounter=function(b,c){var d=this;d.$el=a(b),d.el=b,d.$el.data("textcounter",d),d.init=function(){d.options=a.extend({},a.textcounter.defaultOptions,c);var b=d.options.countDown?d.options.countDownText+d.options.max:d.options.counterText+d.options.max,e=d.options.countDown?d.options.max:0;console.log("max : ",d.options.max," , counterText : ",b),d.$el.after("<"+d.options.countContainerElement+' class="'+d.options.countContainerClass+'"><span class="'+d.options.textCountClass+'">'+e+"</span>"+b+"</"+d.options.countContainerElement+">"),d.$el.bind("keyup.textcounter click.textcounter blur.textcounter focus.textcounter change.textcounter paste.textcounter",d.checkLimits).trigger("click.textcounter"),d.options.init(d.el)},d.checkLimits=function(b){var c=d.$el,f=(c.nextAll("."+d.options.countContainerClass),c.val()),g=0,h=0,i=void 0!==b.originalEvent;if(!a.isEmptyObject(f))if("word"==d.options.type)g=f.trim().replace(/\s+/gi," ").split(" ").length;else if(g=d.options.countSpaces?f.replace(/[^\S\n|\r|\r\n]/g," ").length:f.replace(/\s/g,"").length,d.options.countExtendedCharacters){var j=f.match(/[^\x00-\xff]/gi);g=null==j?f.length:f.length+j.length}if("auto"==d.options.max){var k=d.$el.attr("maxlength");"undefined"!=typeof k&&k!==!1?d.options.max=k:d.$el.nextAll("."+d.options.countContainerClass).text("error: [maxlength] attribute not set")}if(h=d.options.countDown?d.options.max-g:g,d.setCount(h),d.options.min>0&&i&&(g<d.options.min?d.setErrors("min"):g>=d.options.min&&(d.options.mincount(d.el),d.clearErrors("min"))),d.options.max!==-1)if(g>=d.options.max&&0!=d.options.max)if(d.options.maxcount(d.el),d.options.stopInputAtMaximum){var l="";if("word"==d.options.type)for(var m=f.split(/[^\S\n]/g),n=0;n<m.length&&!(n>=d.options.max-1);)void 0!==m[n]&&(l+=m[n]+" ",n++);else if(d.options.countSpaces)l=f.substring(0,d.options.max);else for(var o=f.split(""),p=o.length,q=0,n=0;q<d.options.max&&n<p;)" "!==o[n]&&q++,l+=o[n++];c.val(l.trim()),h=d.options.countDown?0:d.options.max,d.setCount(h)}else d.setErrors("max");else d.clearErrors("max")},d.setCount=function(a){var b=d.$el,c=b.next("."+d.options.countContainerClass);c.children("."+d.options.textCountClass).text(a)},d.setErrors=function(a){var b=d.$el,c=b.nextAll("."+d.options.countContainerClass);if(b.addClass(d.options.inputErrorClass),c.addClass(d.options.counterErrorClass),d.options.displayErrorText){switch(a){case"min":errorText=d.options.minimumErrorText;break;case"max":errorText=d.options.maximumErrorText}c.children(".error-text-"+a).length||c.append("<"+d.options.errorTextElement+' class="error-text error-text-'+a+'">'+errorText+"</"+d.options.errorTextElement+">")}},d.clearErrors=function(a){var b=d.$el,c=b.nextAll("."+d.options.countContainerClass);c.children(".error-text-"+a).remove(),0==c.children(".error-text").length&&(b.removeClass(d.options.inputErrorClass),c.removeClass(d.options.counterErrorClass))},d.init()},a.textcounter.defaultOptions={type:"character",min:0,max:30,countContainerElement:"div",countContainerClass:"text-count-wrapper",textCountClass:"text-count",inputErrorClass:"error",counterErrorClass:"error",counterText:"/",errorTextElement:"div",minimumErrorText:"Minimum not met",maximumErrorText:"Maximum exceeded",displayErrorText:!0,stopInputAtMaximum:!0,countSpaces:!1,countDown:!1,countDownText:"Remaining: ",countExtendedCharacters:!1,maxcount:function(a){},mincount:function(a){},init:function(a){}},a.fn.textcounter=function(b){return this.each(function(){new a.textcounter(this,b)})}}(jQuery);